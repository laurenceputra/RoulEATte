"use strict";function startLocationServices(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){lng=a.coords.longitude,lat=a.coords.latitude},function(a){alert(a)})}function locationSearchURL(a){return a||(a=500),"/v1/location/near/"+lng+"/"+lat+"/distance/"+a}function getListsURL(){return"/v1/user/list/all"}function getListURL(a){return"/v1/user/list/"+encodeURIComponent(a)}function getLists(){!cache.lists||(cache.lists.lastUpdated-Date.now())/1e3>600?ajax(getListsURL(),"GET",null,populateListOptions):populateListOptions(null)}function populateListOptions(a){a&&(cache.lists={},cache.lists.data=a.data,cache.lists.lastUpdated=Date.now()),getList(a.data[0].id)}function getList(a){!cache[a]||(cache[a].lastUpdated-Date.now())/1e3>600?ajax(getListURL(a),"GET",null,populateListDetails):populateListDetails(null)}function populateListDetails(a){a&&(cache[a.data.id]={},cache[a.data.id].data=a.data.list,cache[a.data.id].lastUpdated=Date.now()),selectRandomLocationFromList()}function selectRandomLocationFromList(){}function getSearchResults(){var a=locationSearchURL(distance);ajax(a,"GET",null,receiveSearchResults)}function receiveSearchResults(a){cache.search={},cache.search.data=a.data,cache.search.lastUpdated=Date.now(),selectRandomLocationFromResults()}function selectRandomLocationFromResults(){if(cache.search&&cache.search.data&&0!=cache.search.data.length){var a=Math.floor(Math.random()*cache.search.data.length);cache.search.data[a]}else getSearchResults()}var lng=103.844,lat=1.2921,distance=500,cache={};startLocationServices(),setInterval(startLocationServices,6e4),loggedIn?(getLists(),setTimeout(getSearchResults,1e3)):setTimeout(getSearchResults,1e3);